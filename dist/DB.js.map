{"version":3,"sources":["../src/DB.js"],"names":["DB","Promise","resolve","reject","client","user","encodeURIComponent","config","db","username","password","url","MongoClient","connect","e","getClient","then","name","catch","getDb","collection"],"mappings":";;;;;;;AAEA;;AACA;;;;;;;;;;IAEaA,E;;;;;;;;;gCACQ;AACjB,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,YAAG,CAACH,EAAE,CAACI,MAAP,EAAe;AAEb,cAAMC,IAAI,GAAGC,kBAAkB,CAACC,gBAAOC,EAAP,CAAUC,QAAX,CAA/B;AACA,cAAMC,QAAQ,GAAGJ,kBAAkB,CAACC,gBAAOC,EAAP,CAAUE,QAAX,CAAnC;AAEA,cAAMC,GAAG,uBAAgBN,IAAhB,cAAwBK,QAAxB,cAAoCH,gBAAOC,EAAP,CAAUG,GAA9C,CAAT;;AAEAC,+BAAYC,OAAZ,CAAoBF,GAApB,EAAyB,UAACG,CAAD,EAAIV,MAAJ,EAAe;AACtC,gBAAGU,CAAH,EAAM;AACJ,qBAAOX,MAAM,CAACW,CAAD,CAAb;AACD;;AAEDd,YAAAA,EAAE,CAACI,MAAH,GAAYA,MAAZ;AACAF,YAAAA,OAAO,CAACF,EAAE,CAACI,MAAJ,CAAP;AACD,WAPD;AAQD,SAfD,MAeO;AACLF,UAAAA,OAAO,CAACF,EAAE,CAACI,MAAJ,CAAP;AACD;AACF,OAnBM,CAAP;AAoBD;;;4BAEc;AAAA;;AACb,aAAO,IAAIH,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,QAAA,KAAI,CAACY,SAAL,GACGC,IADH,CACQ,UAAAZ,MAAM,EAAI;AACd,cAAMI,EAAE,GAAGJ,MAAM,CAACI,EAAP,CAAUD,gBAAOC,EAAP,CAAUS,IAApB,CAAX;AACAf,UAAAA,OAAO,CAACM,EAAD,CAAP;AACD,SAJH,EAKGU,KALH,CAKSf,MALT;AAMD,OAPM,CAAP;AAQD;;;kCAEoBc,I,EAAM;AACzB,aAAO,IAAIhB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCH,QAAAA,EAAE,CAACmB,KAAH,GACGH,IADH,CACQ,UAACZ,MAAD,EAAY;AAChB,cAAMgB,UAAU,GAAGhB,MAAM,CAACgB,UAAP,CAAkBH,IAAlB,CAAnB;AACAf,UAAAA,OAAO,CAACkB,UAAD,CAAP;AACD,SAJH,EAKGF,KALH,CAKSf,MALT;AAMD,OAPM,CAAP;AAQD","sourcesContent":["/* jshint esversion: 6 */\n\nimport { MongoClient } from 'mongodb';\nimport config from './config/config';\n\nexport class DB {\n  static getClient() {\n    return new Promise((resolve, reject) => {\n      if(!DB.client) {\n\n        const user = encodeURIComponent(config.db.username);\n        const password = encodeURIComponent(config.db.password);\n\n        const url = `mongodb://${user}:${password}@${config.db.url}`;\n\n        MongoClient.connect(url, (e, client) => {\n          if(e) {\n            return reject(e);\n          }\n\n          DB.client = client;\n          resolve(DB.client);\n        });\n      } else {\n        resolve(DB.client);\n      }\n    });\n  }\n\n  static getDb() {\n    return new Promise((resolve, reject) => {\n      this.getClient()\n        .then(client => {\n          const db = client.db(config.db.name)\n          resolve(db);\n        })\n        .catch(reject);\n    });\n  }\n\n  static getCollection(name) {\n    return new Promise((resolve, reject) => {\n      DB.getDb()\n        .then((client) => {\n          const collection = client.collection(name);\n          resolve(collection);\n        })\n        .catch(reject);\n    });\n  }\n}"],"file":"DB.js"}